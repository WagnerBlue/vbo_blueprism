<?xml version="1.0" encoding="utf-8"?>
<bpr:release xmlns:bpr="http://www.blueprism.co.uk/product/release">
    <bpr:name>SQL SERVER and Configuration</bpr:name>
    <bpr:release-notes />
    <bpr:created>2020-09-17 20:44:22Z</bpr:created>
    <bpr:package-id>17</bpr:package-id>
    <bpr:package-name>SQL Server and Configuration</bpr:package-name>
    <bpr:user-created-by>admin</bpr:user-created-by>
    <bpr:contents count="4">
        <object id="29192c0f-d13c-4769-bed3-9c51217efab4" name="Data - SQL Server" xmlns="http://www.blueprism.co.uk/product/process"><process name="Data - SQL Server" version="6.5.0.12573" bpversion="6.8.0.23415" narrative="SQL Server interaction object.&#xD;&#xA;&#xD;&#xA;Version 2.0" byrefcollection="true" type="object" runmode="Background"><appdef><element name="Application Root"><id>86c30a1c-12a4-44c4-9674-b287d0dfa70d</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>2</camerax><cameray>25</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="cfb6da91-518b-40a3-8e0e-115ff0252ea7" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>-93</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3eacbbb6-d03e-4df7-9904-a3b1ac67c882" type="Normal" published="True"><name>Configure</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="88d8d9e5-f97e-40d6-b049-bb643eb06852" type="Normal" published="False"><name>Raise Exception If Appropriate</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="90429413-7792-4513-8bc0-d6d079aa08b9" type="Normal" published="True"><name>Set Connection</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="459569f2-c792-4948-8884-5c2a0917cc16" type="Normal" published="False"><name>Open</name><view><camerax>-123</camerax><cameray>-57</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="109afac8-f6b2-467f-971c-c6141124b87a" type="Normal" published="False"><name>Close</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3842f7c4-4df2-4e6a-bedd-6dacf01a6db4" type="Normal" published="False"><name>Is Open</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5" type="Normal" published="False"><name>Internal Close</name><view><camerax>-38</camerax><cameray>-69</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="3ee937ec-012f-445c-9b2b-ebbcb6d3614d" type="Normal" published="True"><name>Begin Transaction</name><view><camerax>50</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="ba712d56-697c-48af-bc96-85e49eb968fc" type="Normal" published="True"><name>Commit Transaction</name><view><camerax>43</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="4b6e35c6-8ec4-4fbe-b9d7-d43c48492695" type="Normal" published="True"><name>Rollback Transaction</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="c07ae8a2-a04f-46f2-8919-ec4da73d5b25" type="Normal" published="True"><name>Execute</name><view><camerax>-26</camerax><cameray>12</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="a45f6098-73e2-4639-a002-31592645bfa5" type="Normal" published="True"><name>Get Records Affected</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="12d7c91f-29ac-4711-9614-7ab992dc4b1f" type="Normal" published="True"><name>Get Number</name><view><camerax>26</camerax><cameray>48</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="18349d7d-79b1-4397-a8a0-490ab27f459f" type="Normal" published="True"><name>Get Text</name><view><camerax>0</camerax><cameray>24</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="780529b8-393d-4d1d-bc5f-34f383fe53ec" type="Normal" published="True"><name>Get Collection</name><view><camerax>-50</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="13b6c91d-68e8-46e9-bcab-9261446dc0af" type="Normal" published="True"><name>Get CSV File</name><view><camerax>-50</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="e50a93aa-11fe-4457-a16d-0237560fff18" type="Normal" published="True"><name>Get CSV</name><view><camerax>20</camerax><cameray>-1</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="f3bf5e12-d2cf-4c5d-bda5-0deae3c26316" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d16cc64f-d5d1-4aaf-bea5-f814e1f2657b</onsuccess></stage><stage stageid="d16cc64f-d5d1-4aaf-bea5-f814e1f2657b" name="End" type="End"><loginhibit /><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="0efcc61e-6916-4463-ae94-c24edb2adc75" name="Stage1" type="ProcessInfo"><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><references><reference>System.Data.dll</reference><reference>System.XML.dll</reference></references><imports><import>System</import><import>System.Data</import><import>System.Data.SqlClient</import><import>System.IO</import></imports><language>visualbasic</language><globalcode><![CDATA[

]]></globalcode><code><![CDATA[
Private moConnection As SqlConnection
Private moTransaction As SqlTransaction

Private Sub WriteCsv(ByVal sql As String, ByVal out As TextWriter)

	' The target data set
	Dim ds As New DataSet()

	' Build and execute the command, dumping the data into the above set
    Using cmd As New SqlCommand()
        cmd.Connection = moConnection
        cmd.Transaction = moTransaction
        cmd.CommandText = sql
        
        Using da As New SqlDataAdapter()
            da.SelectCommand = cmd
            da.Fill(ds)
        End Using
	End Using

	' Go through the data, escaping and outputting to the writer
	Dim quotesRequiredChars() As Char = {","c, """"c}
	For Each tab As DataTable In ds.Tables
		' Column headers first
		Dim first As Boolean = True
		For Each col As DataColumn In tab.Columns
			If first Then first = False Else out.Write(",")
			Dim val As String = col.ColumnName
			If val.IndexOfAny(quotesRequiredChars) >= 0 Then _
			 val = """" & val.Replace("""", """""") & """"
			out.Write(val)
		Next
		out.WriteLine()
		' Then a line for each row
		For Each row As DataRow in tab.Rows
			first = True
			For Each col As DataColumn in tab.Columns
				If first Then first = False Else out.Write(",")
				If row.IsNull(col) Then Continue For
				Dim val As String = row(col).ToString()
				If val.IndexOfAny(quotesRequiredChars) >= 0 Then _
				 val = """" & val.Replace("""", """""") & """"
				out.Write(val)
			Next
			out.WriteLine()
		Next
		' Separate each table with a couple of blank lines
		out.WriteLine()
		out.WriteLine()                
	Next
	
	out.Flush()

End Sub

Private Function GetScalar(Of T)(ByVal sql As String, _
 ByRef success As Boolean, ByRef msg As String) As T

	' Assume Success
	success = True
	msg = ""

	Try
		Using cmd As New SqlCommand()
			cmd.Connection = moConnection
			cmd.CommandText = SQL
			cmd.Transaction = moTransaction
			Return CType(cmd.ExecuteScalar(), T)
		End Using
	Catch ex As Exception
		success = False
		msg = ex.Message
		Return Nothing
	End Try

End Function]]></code></stage><stage stageid="fd95e8ae-614b-4bae-a0f9-cbd04cef37ce" name="Clean Up" type="SubSheetInfo"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="e91da0c2-e60f-4eae-a108-bd99aaff046f" name="Start" type="Start"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>88b89098-8bb2-42fc-8e43-bad5b1e4f400</onsuccess></stage><stage stageid="91836284-14a0-4c0f-b9d5-8cd74b4d1632" name="End" type="End"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="cf7a7a0d-0c2b-4a9e-8a52-19bdf46ef4cc" name="Set Connection" type="SubSheetInfo"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="5395eb12-61a3-4005-88a3-ceda307cf9b1" name="Start" type="Start"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="15" y="-165" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Server" narrative="The name of the server and, if necessary, instance name of the SQL Server instance to connect to" stage="Server" /><input type="text" name="Database" narrative="The name of the database to connect to" stage="Database" /><input type="text" name="User" narrative="If appropriate, the login name to use to connect to SQL Server. If left empty, windows authentication using the current user will be used instead of SQL Server authentication" stage="User" /><input type="password" name="Password" narrative="If appropriate, the password to use with the above login name to access SQL Server. Unused for windows authentication" stage="Password" /></inputs><onsuccess>66c19ef6-3007-4fa0-af27-b52892a9671c</onsuccess></stage><stage stageid="823a5018-5ad8-483c-a6c1-8c527bf7bc00" name="End" type="End"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="15" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="78309214-2fb3-4bd9-8433-ca0f0fc31bd4" name="new" type="Note"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically by Automate immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="7bb7dcd7-acf2-4a7a-a96d-756830b2e54f" name="new" type="Note"><loginhibit /><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically by Automate immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="d666ce88-be59-4711-8698-025945395207" name="Server" type="Data"><loginhibit /><display x="180" y="-105" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="b9720411-39cf-4e79-8fe9-af8e7581970a" name="Database" type="Data"><loginhibit /><display x="180" y="-60" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="d1d97b89-18c2-40ab-8f43-0cd0ce45f5b7" name="User" type="Data"><loginhibit /><display x="180" y="-15" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="1c8bc019-fa8a-4593-b435-81216f908452" name="Password" type="Data"><loginhibit /><display x="180" y="30" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>password</datatype><initialvalueenc></initialvalueenc></stage><stage stageid="c9568fbf-1fca-4ce7-aa27-2309731df7f5" name="Connection String" type="Data"><loginhibit /><display x="180" y="75" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /></stage><stage stageid="db11541e-1f1d-48f5-a64e-e1d44d23ecf6" name="Set connection" type="Calculation"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="-30" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>823a5018-5ad8-483c-a6c1-8c527bf7bc00</onsuccess><calculation expression="&quot;database=&quot; &amp; [Database] &amp; &quot;;data source=&quot; &amp; [Server] &amp; &quot;; user id=&quot; &amp; [User] &amp; &quot;;password=&quot; &amp; [Password]" stage="Connection String" /></stage><stage stageid="8ed153e9-383f-4acf-9e86-3d058f27a895" name="Open" type="SubSheetInfo"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="3c501978-f53e-419d-ab66-c3cbef5cf598" name="Start" type="Start"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="-60" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c57babb2-f4b2-42dd-95c7-a8155b854975</onsuccess></stage><stage stageid="7295054b-4d97-4891-ab69-23416df80d09" name="End" type="End"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="-60" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="c57babb2-f4b2-42dd-95c7-a8155b854975" name="Open" type="Code"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="-60" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="ConnectionString" expr="[Connection String]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>1c7fc106-01f3-4a2a-aa7e-44c44875fb04</onsuccess><code><![CDATA[Success = True
Message = ""

If moConnection IsNot Nothing Then Return
Try
	moConnection = New SqlConnection(ConnectionString)
	moConnection.Open()

Catch ex As Exception
	Success = False
	Message = ex.Message

End Try
]]></code></stage><stage stageid="24f2742e-2541-4680-a355-1783c4e2f2f2" name="Execute" type="SubSheetInfo"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="05448135-b8ce-4a88-9d5c-eb85fea9d352" name="Start" type="Start"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-15" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Query" narrative="The SQL query to use to perform this action" stage="SQL" /></inputs><onsuccess>3753873b-7231-4b1f-947e-e6b87deac3d8</onsuccess></stage><stage stageid="3810933f-d93a-482c-a0d8-20796ecd3049" name="Execute" type="Code"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-15" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" expr="[SQL]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /><output type="number" name="Records Affected" stage="Records Affected" /></outputs><onsuccess>2631d241-e7fb-4a03-87f8-846c6443206f</onsuccess><code><![CDATA[
Success = True
Message = ""

Try
	Using cmd As New SqlCommand()
		cmd.Connection = moConnection
		cmd.CommandText = SQL
		cmd.Transaction = moTransaction
		Records_Affected = cmd.ExecuteNonQuery()
	End Using

Catch ex As Exception
	Success = False
	Message = ex.Message

End Try
]]></code></stage><stage stageid="3753873b-7231-4b1f-947e-e6b87deac3d8" name="Open" type="SubSheet"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-15" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>1ac9d798-c898-4a5a-8b07-f435dc0500d4</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="1ac9d798-c898-4a5a-8b07-f435dc0500d4" name="Success?" type="Decision"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="75" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>3810933f-d93a-482c-a0d8-20796ecd3049</ontrue><onfalse>dbe6faa5-9cd8-4ead-a98d-1880a84975af</onfalse></stage><stage stageid="4a78a3ea-35e5-4496-bfe0-509900dc5137" name="Internal Close" type="SubSheetInfo"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="-195" y="-180" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f5aab680-3f4a-4cb2-9873-7c2aa718133f" name="Close" type="Code"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="clearPool" expr="[Clear Pool]" /><input type="text" name="connString" expr="[Connection String]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>274a1082-2d15-4bf8-84f2-043aae4e60e7</onsuccess><code><![CDATA[
Success = True
Message = ""

Try
	' If we're clearing the pool, we need a
	' connection so that we can specify the pool
	' we want to clear, so, somewhat obscenely,
	' we must create a connection if one does not
	' currently exist. Then close it immediately
	If clearPool Then
		If moConnection Is Nothing Then _
		 moConnection = New SqlConnection(connString)
		SqlConnection.ClearPool(moConnection)
	End If
	If moConnection IsNot Nothing Then
		moConnection.Close()
		moConnection.Dispose()
		moConnection = Nothing
	End If

Catch ex As Exception
	Success = False
	Message = ex.Message
End Try
]]></code></stage><stage stageid="b0d71d51-0e09-4333-a7e8-e16c11d5cc2c" name="Internal Close" type="SubSheet"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="75" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>28719a2d-9d55-4414-8a91-4f3c8ce10cba</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="2f46d078-5aeb-4c4a-a493-e807b2c7a995" name="Get Number" type="SubSheetInfo"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="f2d1ef6c-115c-4900-9a62-d8bac04b0b09" name="Start" type="Start"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="0" y="-75" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Query" narrative="The SQL query to use to perform this action" stage="SQL" /></inputs><onsuccess>05b0b107-7095-4e9d-bc37-924f6b11869d</onsuccess></stage><stage stageid="3098273a-9d5f-43bd-8f67-dd5fa306c621" name="End" type="End"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="0" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="number" name="Result" narrative="The numeric result from the SQL query provided - if multiple results were generated, this will be the first result from the first result set" stage="Number Result" /><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="17da1b91-9f66-4fe1-b2e3-ff423f3f827a" name="Execute Return Number" type="Code"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="0" y="15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" expr="[SQL]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /><output type="number" name="Result" stage="Number Result" /></outputs><onsuccess>12f14b00-5eb3-4995-afa2-e3eeeadcb5c0</onsuccess><code><![CDATA[
Result = GetScalar(Of Decimal)( _
 SQL, Success, Message)
]]></code></stage><stage stageid="05b0b107-7095-4e9d-bc37-924f6b11869d" name="Open" type="SubSheet"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="0" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>4f04e547-353a-4b31-9d76-06f4a406e438</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="4f04e547-353a-4b31-9d76-06f4a406e438" name="Success?" type="Decision"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="90" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>17da1b91-9f66-4fe1-b2e3-ff423f3f827a</ontrue><onfalse>0da291c6-e906-4852-b112-79384aafeb77</onfalse></stage><stage stageid="06bce91a-1f23-4c23-acdf-19564c453382" name="Number Result" type="Data"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="-195" y="60" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue><private /></stage><stage stageid="1e9d4de5-9638-4bec-a23c-dda3f743abd2" name="Get Records Affected" type="SubSheetInfo"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1bc1e722-9f5a-4ca8-becb-07c73ba5427b" name="Start" type="Start"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="0" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Query" narrative="The SQL query to use to perform this action" stage="SQL" /></inputs><onsuccess>ec1e523c-2d7f-49ab-bdbf-97c9629d4f0b</onsuccess></stage><stage stageid="5c3b4cc9-288d-4fae-b9d3-dca1f01d452c" name="End" type="End"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="0" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="number" name="Records Affected" narrative="The number of records which matched the constraints specified in the SQL provided" stage="Records Affected" /><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="98ced6bf-c219-4b6f-8788-428ae730dffa" name="Records Affected" type="Data"><loginhibit /><display x="180" y="165" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>number</datatype><initialvalue>0</initialvalue></stage><stage stageid="ec1e523c-2d7f-49ab-bdbf-97c9629d4f0b" name="Execute" type="SubSheet"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="0" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Query" expr="[SQL]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>5c3b4cc9-288d-4fae-b9d3-dca1f01d452c</onsuccess><processid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</processid></stage><stage stageid="b302f1fb-5a49-4ea5-a4f3-1dadc0ab9051" name="Get Text" type="SubSheetInfo"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="1841a582-8544-4daa-ace7-1e0e40837056" name="Start" type="Start"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-15" y="-75" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="Query" narrative="The SQL query to use to perform this action" stage="SQL" /></inputs><onsuccess>eb060128-54bc-417e-9d48-71beda3e0d4d</onsuccess></stage><stage stageid="281eca77-1f39-4ace-8815-a8145727a1e3" name="End" type="End"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-15" y="150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="text" name="Result" narrative="The text result from the SQL query provided - if multiple results were generated, this will be the first result from the first result set" stage="Text Result" /><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="9f94c434-d4c4-43a6-9393-df126ab0c0ca" name="Execute Return Text" type="Code"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-15" y="15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" expr="[SQL]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /><output type="text" name="Result" stage="Text Result" /></outputs><onsuccess>d689a9ea-0ae1-4208-b0ca-ece39ddd838f</onsuccess><code><![CDATA[
Result = GetScalar(Of String)( _
 SQL, Success, Message)
]]></code></stage><stage stageid="eb060128-54bc-417e-9d48-71beda3e0d4d" name="Open" type="SubSheet"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-15" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>9c17dfa7-6435-4b40-a7db-533bfe76902f</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="9c17dfa7-6435-4b40-a7db-533bfe76902f" name="Success?" type="Decision"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="75" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>9f94c434-d4c4-43a6-9393-df126ab0c0ca</ontrue><onfalse>8e6271bb-9473-4b6c-b90d-6832537a8075</onfalse></stage><stage stageid="8fa93518-b432-4252-bf80-0a9c96171faa" name="Text Result" type="Data"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-195" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /></stage><stage stageid="88b89098-8bb2-42fc-8e43-bad5b1e4f400" name="Internal Close" type="SubSheet"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><display x="15" y="-15" w="60" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="True" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>91836284-14a0-4c0f-b9d5-8cd74b4d1632</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="8eebcae5-eab4-4d0d-98ac-60bb9a4f645c" name="Begin Transaction" type="SubSheetInfo"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="110c04fd-0f65-422a-ad21-bdb7db8a4a96" name="Start" type="Start"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><preconditions><condition narrative="None" /></preconditions><postconditions><condition narrative="A transaction will be started on the currently open connection" /></postconditions><display x="15" y="-180" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6a763136-0514-4c6d-9dff-0a0c4a1d10e7</onsuccess></stage><stage stageid="eac4efa0-7168-4dee-a333-0923f422d458" name="Begin Transaction" type="Code"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>a0610c45-e0f3-48ce-86be-2d9fe00d5faf</onsuccess><code><![CDATA[' Assume Success
Success = True
Message = ""

Try
	moTransaction = moConnection.BeginTransaction()
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try
]]></code></stage><stage stageid="faff14a4-e148-47ec-8e4d-fc4e4bc1519d" name="Commit Transaction" type="SubSheetInfo"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="-285" y="-120" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="dcca40c4-f5b7-4875-b4b4-1c8c50a4be99" name="Start" type="Start"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>175695ba-0b55-4490-b99a-7c5fa1e95899</onsuccess></stage><stage stageid="01c9256c-c4e8-47d0-8bce-cbb4f916399d" name="Commit Transaction" type="Code"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="-45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>f26aaae6-36b1-4739-9465-1e208144a8bf</onsuccess><code><![CDATA[
' Assume success
Success = True
Message = ""

Try
	moTransaction.Commit()
	moTransaction = Nothing
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try
]]></code></stage><stage stageid="e2cc64c2-12bd-4614-bca3-0650718ccfee" name="Rollback Transaction" type="SubSheetInfo"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="-225" y="-135" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="245c9f37-0f51-4fd3-aaa9-480630d4ac3f" name="Start" type="Start"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="-150" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>093c958e-ad24-4cb8-bfd6-e9f7dba49311</onsuccess></stage><stage stageid="921f479a-2714-4314-b394-c5c941b281e8" name="Rollback Transaction" type="Code"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="-60" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>7c11fab5-28c4-48fd-b752-cbeac0598534</onsuccess><code><![CDATA[
Success = True
Message = ""

Try
	moTransaction.Rollback()
	moTransaction = Nothing
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try
]]></code></stage><stage stageid="2631d241-e7fb-4a03-87f8-846c6443206f" name="In Transaction?" type="Decision"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-15" y="0" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>ac70463c-d9f4-44cc-8427-004224405a91</ontrue><onfalse>b0d71d51-0e09-4333-a7e8-e16c11d5cc2c</onfalse></stage><stage stageid="f3d61e3c-3094-4c38-9370-3d142d7448c1" name="In Transaction" type="Data"><loginhibit /><display x="180" y="210" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue></stage><stage stageid="0441a51b-0a7c-49e6-8305-4a877c32cc8a" name="In Transaction" type="Calculation"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>5705d9af-28ea-4c05-832b-4f40d34a3511</onsuccess><calculation expression="True" stage="In Transaction" /></stage><stage stageid="f26aaae6-36b1-4739-9465-1e208144a8bf" name="Not In Transaction" type="Calculation"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6cc92a8f-1561-462a-8eaf-bbd32e32a936</onsuccess><calculation expression="False" stage="In Transaction" /></stage><stage stageid="7c11fab5-28c4-48fd-b752-cbeac0598534" name="Not In Transaction" type="Calculation"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="-15" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>876d7128-a56d-4c53-8fde-3713a1c173f5</onsuccess><calculation expression="False" stage="In Transaction" /></stage><stage stageid="28719a2d-9d55-4414-8a91-4f3c8ce10cba" name="anchor1" type="Anchor"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="135" y="0" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>63e4c694-de67-4b39-a04c-5af3186af635</onsuccess></stage><stage stageid="269b8cc6-856b-426a-ba48-b362a98fc752" name="Internal Close" type="SubSheet"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="90" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>047bee83-bd7d-43b1-aeb3-6f4183c42c63</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="12f14b00-5eb3-4995-afa2-e3eeeadcb5c0" name="In Transaction?" type="Decision"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="0" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>8173e4d5-0932-4184-b3e8-01a761341966</ontrue><onfalse>269b8cc6-856b-426a-ba48-b362a98fc752</onfalse></stage><stage stageid="ffd23eb7-b1b9-4f82-ad2f-05d4db50bcd2" name="Internal Close" type="SubSheet"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="75" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>61bf908d-c640-41f1-921e-fbac0bc44b57</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="d689a9ea-0ae1-4208-b0ca-ece39ddd838f" name="In Transaction?" type="Decision"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-15" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>8ecc58ce-889b-4d69-8dbd-43f4c4cb11aa</ontrue><onfalse>ffd23eb7-b1b9-4f82-ad2f-05d4db50bcd2</onfalse></stage><stage stageid="221cc4f2-f3b6-4a62-985a-350066ad7c79" name="Get Collection" type="SubSheetInfo"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="76ba8075-200c-47f3-a5b0-81d2a545b93b" name="Start" type="Start"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-45" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" narrative="The SQL query to use to perform this action" stage="SQL" /></inputs><onsuccess>98267e1e-20b7-4ce9-a0b8-847c18c1976f</onsuccess></stage><stage stageid="469b68e3-523f-4723-ab11-b47348bbdf33" name="End" type="End"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-45" y="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /><output type="collection" name="Results" narrative="The collection of results from the query" stage="Results" /></outputs></stage><stage stageid="897f736f-bc15-4938-9d97-b4c1065dd5e1" name="Get Data Table" type="Code"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-45" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" expr="[SQL]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /><output type="collection" name="Results" stage="Results" /></outputs><onsuccess>f6c917ac-401f-416b-9653-21ef09eb5511</onsuccess><code><![CDATA[
' Assume success
Success = True
Message = ""

Try
	Using cmd As New SqlCommand()
		cmd.Connection = moConnection
		cmd.Transaction = moTransaction
		cmd.CommandText = SQL

		Using adapter As New SqlDataAdapter()
			adapter.SelectCommand = cmd
			Dim ds As New DataSet()
			adapter.Fill(ds)
			Results = ds.Tables(0)
		End Using
	End Using

Catch ex As Exception
	Success = False
	Message = ex.Message

End Try]]></code></stage><stage stageid="98267e1e-20b7-4ce9-a0b8-847c18c1976f" name="Open" type="SubSheet"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-45" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>1c0c847f-0d0a-4f0d-9c66-25a64b4c477f</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="1c0c847f-0d0a-4f0d-9c66-25a64b4c477f" name="Success?" type="Decision"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="90" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>897f736f-bc15-4938-9d97-b4c1065dd5e1</ontrue><onfalse>a32a083a-756d-4b40-9291-f7f28eb270ca</onfalse></stage><stage stageid="71604ec6-dbf3-40c1-b400-8a5eea8eda3f" name="Results" type="Collection"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-195" y="0" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>collection</datatype><private /><alwaysinit /></stage><stage stageid="6247786f-c914-40c2-9acb-156178f5b62d" name="anchor2" type="Anchor"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="90" y="75" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>d5771181-59a5-4bfd-b8f1-01bd7b7dbb3d</onsuccess></stage><stage stageid="99f0a166-b905-44ab-ba9d-1fa79b71f6f6" name="Success" type="Data"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="60" y="-135" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="e981674b-56d4-4624-8c36-d156009e2a52" name="Message" type="Data"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="60" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f81f3fe8-65f8-4b08-928d-1e9b3a2d8db1" name="Success" type="Data"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="-195" y="-105" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="728d45f7-0717-4872-ab22-b9ae8a142957" name="Message" type="Data"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="-195" y="-75" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="67c3cea7-7915-4e88-9e86-a1355e251b7d" name="Success" type="Data"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="345" y="-135" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="71de5830-7d23-4ba9-8354-30f54dacdff4" name="Message" type="Data"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="345" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d5b51384-618c-4c4a-8510-baa7b99b6e20" name="Success" type="Data"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="150" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="29a89d90-a1e6-4a7d-8586-d40cb4c63a97" name="Message" type="Data"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="150" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="235b42fd-91d3-4351-bef7-4e7407a29ffe" name="Success" type="Data"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="150" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="92878142-4175-4d93-90d4-7ea4dd84f1da" name="Message" type="Data"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="150" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b50d625f-a5cd-464b-bc26-3a94288c485e" name="Success" type="Data"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-195" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="8eeb44dd-6e76-4f9d-9988-c3638cc5916c" name="Message" type="Data"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-195" y="30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a1938177-269a-461e-b3fa-7cb2714659a8" name="Success" type="Data"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="-195" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="079adbce-1d95-4720-b83f-0567741a0749" name="Message" type="Data"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="-195" y="30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8ac84956-cd26-456e-a622-6b3426601f4a" name="Success" type="Data"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="-195" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="c40edd8e-a34c-49ad-ad39-9025a0f9b946" name="Message" type="Data"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="-195" y="30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="34a8e2f0-1a6b-4bdc-b2d2-46fed237de50" name="Success" type="Data"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-195" y="0" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="f2ebc91f-7722-42d3-907c-6bf37b0cd1e7" name="Message" type="Data"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-195" y="30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="20e595a2-0799-4731-b244-c3cf6be8d791" name="Success" type="Data"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-195" y="30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="97efd2f3-8f58-454f-b7ef-db9e6bef8aea" name="Message" type="Data"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-195" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="95a4ec5c-e0ae-43f8-958e-c44907def3f0" name="Get CSV File" type="SubSheetInfo"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="518048a9-d28c-48bd-889f-30dab7f502e0" name="Start" type="Start"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-45" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" narrative="The SQL query to use to perform this action" stage="SQL" /><input type="text" name="File" narrative="The full path of the file to which the CSV result should be written" stage="File" /></inputs><onsuccess>8d11deee-1ae6-42be-8726-53fb6cc7e117</onsuccess></stage><stage stageid="f82dbcac-aaf6-4e85-ada7-e7f28d96bb97" name="End" type="End"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-45" y="135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="9af3a6f4-53d9-4e14-9e1e-9c161160fec6" name="Get File" type="Code"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-45" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" expr="[SQL]" /><input type="text" name="File" expr="[File]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>60210b0d-63bf-4d91-be71-5cb25dd207ee</onsuccess><code><![CDATA[
' Assume success
Success = True
Message = ""

Try
	' Write it out using the method in Global Code
	Using sw As New StreamWriter(File, False)
		WriteCsv(SQL, sw)
	End Using
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try
]]></code></stage><stage stageid="8d11deee-1ae6-42be-8726-53fb6cc7e117" name="Open" type="SubSheet"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-45" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>be5bca8d-64c2-4521-a293-b1a736a543bf</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="be5bca8d-64c2-4521-a293-b1a736a543bf" name="Success?" type="Decision"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="90" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>9af3a6f4-53d9-4e14-9e1e-9c161160fec6</ontrue><onfalse>4657807d-cf0b-4fb1-99dc-00b8e1996c90</onfalse></stage><stage stageid="8ee4a00c-f248-4c89-8c4b-4b86cb50ad50" name="anchor2" type="Anchor"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="90" y="75" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>7dc1a88f-716e-4f2b-80dd-dd6306d6db07</onsuccess></stage><stage stageid="47d47b05-34f0-49f6-b703-f594ecee8108" name="Success" type="Data"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-195" y="30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="c26f4e3a-832a-4e80-a4b5-cf864ee7abb4" name="Message" type="Data"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-195" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6bb45052-f59c-4af2-866e-d7973096bc2a" name="File" type="Data"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><display x="-195" y="0" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="7d3515fc-4af8-451d-96e6-cc2d4c6808c7" name="Get CSV" type="SubSheetInfo"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="70f8039e-4af2-4364-b7d2-483c6d3260a4" name="Start" type="Start"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="15" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" narrative="The SQL query to use to perform this action" stage="SQL" /></inputs><onsuccess>e1bfc556-cb0c-49cf-8cfd-2767e9516e59</onsuccess></stage><stage stageid="029dc82b-e289-4579-8a43-d8b9c93158be" name="End" type="End"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="15" y="135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /><output type="text" name="CSV" narrative="The CSV output from the query" stage="CSV" /></outputs></stage><stage stageid="584fab2b-6e03-4169-8b6f-2032ad3893b3" name="Get CSV" type="Code"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="15" y="-15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="text" name="SQL" expr="[SQL]" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /><output type="text" name="CSV" stage="CSV" /></outputs><onsuccess>b2e92c46-8b47-47ad-a059-a7dbd0c185ea</onsuccess><code><![CDATA[
' Assume success
Success = True
Message = ""

Try
	' Write it out using the method in Global Code
	Using sw As New StringWriter()
		WriteCsv(SQL, sw)
		CSV = sw.ToString()
	End Using
Catch ex As Exception
	Success = False
	Message = ex.Message
End Try
]]></code></stage><stage stageid="e1bfc556-cb0c-49cf-8cfd-2767e9516e59" name="Open" type="SubSheet"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="15" y="-60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>0288c100-557c-4271-8753-82f7651c876c</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="0288c100-557c-4271-8753-82f7651c876c" name="Success?" type="Decision"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="150" y="-60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>584fab2b-6e03-4169-8b6f-2032ad3893b3</ontrue><onfalse>7cf58f46-d16c-44dd-ad75-b675ae326a72</onfalse></stage><stage stageid="1303eb98-48c5-438c-aa5a-54fe90868c4f" name="anchor2" type="Anchor"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="150" y="90" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>69fcc128-f010-4628-a2ca-291756ca05b9</onsuccess></stage><stage stageid="233b888b-7601-4969-8205-7513d73f088d" name="Success" type="Data"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="-195" y="-15" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="5723f6bf-aa06-451d-a08a-e92cdfdf9013" name="Message" type="Data"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="-195" y="15" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d1458d90-c2cf-4c78-879a-d30165d35480" name="CSV" type="Data"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><display x="-195" y="45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3f4ca0da-93ad-492e-af65-ff637c54b37a" name="User Set?" type="Decision"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><narrative>If the user is not set than this must be LAN connection</narrative><display x="15" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[User]&lt;&gt;&quot;&quot;" /><ontrue>db11541e-1f1d-48f5-a64e-e1d44d23ecf6</ontrue><onfalse>fbf4d6d4-763b-41f2-926a-ce6745964763</onfalse></stage><stage stageid="fbf4d6d4-763b-41f2-926a-ce6745964763" name="Set connection" type="Calculation"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="60" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>823a5018-5ad8-483c-a6c1-8c527bf7bc00</onsuccess><calculation expression="&quot;database=&quot; &amp; [Database] &amp; &quot;;data source=&quot; &amp; [Server] &amp; &quot;;Trusted_Connection=Yes&quot;" stage="Connection String" /></stage><stage stageid="68cc3f0e-e762-450c-921f-2cfbccedfead" name="Close Success" type="Data"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><display x="195" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5b2f24bf-84b2-4292-8cb3-df7286ec6cee" name="Close Message" type="Data"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><display x="195" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="8365b22c-f9dd-44ac-9bdf-968ef941b1b7" name="Close Success" type="Data"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><display x="-195" y="90" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a546aa36-ad70-4a81-9648-1de977e52ea0" name="Close Message" type="Data"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><display x="-195" y="120" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e75dc2f8-ea07-48f4-b2a7-245ca2da63bd" name="Close Success" type="Data"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><display x="-195" y="90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4049cd6d-bffc-4414-abba-d9c2c426354a" name="Close Message" type="Data"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><display x="-195" y="120" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="c16520e0-e8d3-41c0-ae96-6254e954bc1a" name="In A Transaction?" type="Decision"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="-105" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>e52851c8-abcd-46d9-b76a-921773c5cbb4</ontrue><onfalse>f185afb3-9c52-4c13-81d3-55a11480cf64</onfalse></stage><stage stageid="e52851c8-abcd-46d9-b76a-921773c5cbb4" name="Rollback Transaction" type="SubSheet"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>f5aab680-3f4a-4cb2-9873-7c2aa718133f</onsuccess><processid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</processid></stage><stage stageid="f185afb3-9c52-4c13-81d3-55a11480cf64" name="anchor3" type="Anchor"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="-75" y="-105" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>384bb280-cd20-4a3c-b8b0-9a97e61f7010</onsuccess></stage><stage stageid="384bb280-cd20-4a3c-b8b0-9a97e61f7010" name="anchor4" type="Anchor"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="-75" y="15" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f5aab680-3f4a-4cb2-9873-7c2aa718133f</onsuccess></stage><stage stageid="20f109d0-a273-44a5-b964-b45248511186" name="Is Open" type="SubSheetInfo"><subsheetid>3842f7c4-4df2-4e6a-bedd-6dacf01a6db4</subsheetid><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="cc3b1970-2275-44bb-8cfd-176166531993" name="Start" type="Start"><subsheetid>3842f7c4-4df2-4e6a-bedd-6dacf01a6db4</subsheetid><loginhibit /><display x="15" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>42ae3b51-badc-419e-9609-b0ce24dc7fe3</onsuccess></stage><stage stageid="8992da0e-f17e-401d-81a4-cf0dbeaf3af1" name="End" type="End"><subsheetid>3842f7c4-4df2-4e6a-bedd-6dacf01a6db4</subsheetid><loginhibit /><display x="15" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Is Open" narrative="Flag indicating if a connection is currently open in this VBO" stage="IsOpen" /></outputs></stage><stage stageid="42ae3b51-badc-419e-9609-b0ce24dc7fe3" name="Check Connection" type="Code"><subsheetid>3842f7c4-4df2-4e6a-bedd-6dacf01a6db4</subsheetid><loginhibit /><display x="15" y="-90" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="IsOpen" stage="IsOpen" /></outputs><onsuccess>8992da0e-f17e-401d-81a4-cf0dbeaf3af1</onsuccess><code><![CDATA[IsOpen = ( _
  moConnection IsNot Nothing AndAlso _
  moConnection.State = ConnectionState.Open _
)]]></code></stage><stage stageid="aafe4270-a6b3-4607-878e-86975da9c5cf" name="IsOpen" type="Data"><subsheetid>3842f7c4-4df2-4e6a-bedd-6dacf01a6db4</subsheetid><display x="-195" y="-30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0a7585ee-e2b5-4c76-893e-f1c483a97130" name="Is Open?" type="Decision"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Is Open]" /><ontrue>a06c1db3-79bd-492a-8c88-aca6b858c053</ontrue><onfalse>9eb59433-0a23-4cdd-bd25-7ae10e31947e</onfalse></stage><stage stageid="330a716e-6d2d-495c-9921-2660dfeb6210" name="Is Open" type="SubSheet"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Is Open" narrative="Flag indicating if a connection is currently open in this VBO" stage="Is Open" /></outputs><onsuccess>0a7585ee-e2b5-4c76-893e-f1c483a97130</onsuccess><processid>3842f7c4-4df2-4e6a-bedd-6dacf01a6db4</processid></stage><stage stageid="2a427672-1805-4178-8c75-5c94c4b82f09" name="Is Open" type="Data"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><display x="-195" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="a06c1db3-79bd-492a-8c88-aca6b858c053" name="anchor5" type="Anchor"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="-60" y="-45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6ff75f66-de9a-4114-98e6-f985272a313b</onsuccess></stage><stage stageid="6ff75f66-de9a-4114-98e6-f985272a313b" name="anchor6" type="Anchor"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="-60" y="45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>eac4efa0-7168-4dee-a333-0923f422d458</onsuccess></stage><stage stageid="9eb59433-0a23-4cdd-bd25-7ae10e31947e" name="Open" type="SubSheet"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>9a9f6e74-7cd8-4580-af73-041602ccba94</onsuccess><processid>459569f2-c792-4948-8884-5c2a0917cc16</processid></stage><stage stageid="9a9f6e74-7cd8-4580-af73-041602ccba94" name="Success?" type="Decision"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="120" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>eac4efa0-7168-4dee-a333-0923f422d458</ontrue><onfalse>62fbd57b-30bc-4365-9fcb-62860030332f</onfalse></stage><stage stageid="62fbd57b-30bc-4365-9fcb-62860030332f" name="anchor5" type="Anchor"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="180" y="0" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>52f9aedd-8666-495d-a007-ef3c02028ee7</onsuccess></stage><stage stageid="c0d90f91-927f-45e0-84a0-0d6b4e823f6c" name="anchor6" type="Anchor"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="180" y="135" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>5705d9af-28ea-4c05-832b-4f40d34a3511</onsuccess></stage><stage stageid="175695ba-0b55-4490-b99a-7c5fa1e95899" name="In Transaction?" type="Decision"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>01c9256c-c4e8-47d0-8bce-cbb4f916399d</ontrue><onfalse>7b32c515-605e-41e1-ae0c-9ad7c7ee6dab</onfalse></stage><stage stageid="7b32c515-605e-41e1-ae0c-9ad7c7ee6dab" name="Error Message" type="Calculation"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="-105" y="-90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c20b6f48-8689-4164-9435-7d9f6f5f2aa7</onsuccess><calculation expression="&quot;There is no open transaction to commit&quot;" stage="Message" /></stage><stage stageid="c20b6f48-8689-4164-9435-7d9f6f5f2aa7" name="anchor7" type="Anchor"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="-105" y="45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6cc92a8f-1561-462a-8eaf-bbd32e32a936</onsuccess></stage><stage stageid="093c958e-ad24-4cb8-bfd6-e9f7dba49311" name="In Transaction?" type="Decision"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="-105" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>921f479a-2714-4314-b394-c5c941b281e8</ontrue><onfalse>d5c94e05-a642-4107-b7b6-15ce461428e7</onfalse></stage><stage stageid="d5c94e05-a642-4107-b7b6-15ce461428e7" name="Error Message" type="Calculation"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="-105" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ae90029d-81d2-4ae3-b27a-f7a302533401</onsuccess><calculation expression="&quot;There is no open transaction to rollback&quot;" stage="Message" /></stage><stage stageid="6cc92a8f-1561-462a-8eaf-bbd32e32a936" name="Internal Close" type="SubSheet"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>63aeb2d7-aeb8-41f2-9ea1-0fd0cea0da8d</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="10757947-9682-4dcb-b789-93777cb333b1" name="Close Success" type="Data"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><display x="150" y="15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="18b41ab6-a52b-45ff-874e-ffece3292e4b" name="Close Message" type="Data"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><display x="150" y="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ae90029d-81d2-4ae3-b27a-f7a302533401" name="anchor7" type="Anchor"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="-105" y="30" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>876d7128-a56d-4c53-8fde-3713a1c173f5</onsuccess></stage><stage stageid="876d7128-a56d-4c53-8fde-3713a1c173f5" name="Internal Close" type="SubSheet"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>375d6173-3de9-4f72-bee6-b4ff132e1287</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="2e2a27c5-d63d-44b0-b693-e673844e664e" name="Close Success" type="Data"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><display x="135" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4e5cc1d8-b2a7-45b7-a8eb-7dbedcfb4f2b" name="Close Message" type="Data"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><display x="135" y="75" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="e652ce3f-f9fc-414a-9006-2616854cb925" name="Start" type="Start"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="-240" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" stage="Clear Pool" /></inputs><onsuccess>8c118cde-3b9a-4ed9-861d-f48b007e1200</onsuccess></stage><stage stageid="382d3006-4861-4bfe-a57e-3f65fbce6c2c" name="Clear Pool" type="Data"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><display x="-195" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>True</initialvalue><private /><alwaysinit /></stage><stage stageid="96ed6cdf-d202-4b37-b3e4-ae598756fb96" name="Close" type="SubSheetInfo"><subsheetid>109afac8-f6b2-467f-971c-c6141124b87a</subsheetid><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="30b5ba60-22d3-4fe6-9e92-9269372d1a6c" name="Start" type="Start"><subsheetid>109afac8-f6b2-467f-971c-c6141124b87a</subsheetid><loginhibit /><display x="-45" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>25dfab67-8902-4f2a-8a18-a776aead1331</onsuccess></stage><stage stageid="25dfab67-8902-4f2a-8a18-a776aead1331" name="Internal Close" type="SubSheet"><subsheetid>109afac8-f6b2-467f-971c-c6141124b87a</subsheetid><loginhibit /><display x="-45" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs><onsuccess>042dd86c-3c68-4015-83b1-dcf5b036fc90</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="6c042b25-556f-4563-9663-c41aecc77a31" name="Success" type="Data"><subsheetid>109afac8-f6b2-467f-971c-c6141124b87a</subsheetid><display x="75" y="-105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d1d7e2ef-771a-4001-922b-fd1f3881328f" name="Message" type="Data"><subsheetid>109afac8-f6b2-467f-971c-c6141124b87a</subsheetid><display x="75" y="-60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6a763136-0514-4c6d-9dff-0a0c4a1d10e7" name="In Transaction?" type="Decision"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="-135" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>32130444-6454-4780-80fd-2b005ed696a4</ontrue><onfalse>330a716e-6d2d-495c-9921-2660dfeb6210</onfalse></stage><stage stageid="32130444-6454-4780-80fd-2b005ed696a4" name="Transaction Already Open Error" type="Calculation"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="180" y="-135" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>62fbd57b-30bc-4365-9fcb-62860030332f</onsuccess><calculation expression="&quot;A transaction is already open in this connection&quot;" stage="Message" /></stage><stage stageid="c8303f15-a646-4677-8a63-2f0904ef1815" name="Close Success" type="Data"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><display x="165" y="-30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="17c8449f-6f6b-4cba-a705-ce95ef3e49e0" name="Close Message" type="Data"><subsheetid>cfb6da91-518b-40a3-8e0e-115ff0252ea7</subsheetid><loginhibit /><display x="165" y="0" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ba273a3e-4b65-4f6b-8ec6-6676a2bede70" name="Configure" type="SubSheetInfo"><subsheetid>3eacbbb6-d03e-4df7-9904-a3b1ac67c882</subsheetid><narrative>Configures this instance of the utility VBO. Calling it with no parameters will cause the configuration to be reset to default values.</narrative><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="b1167043-5e4b-4cbf-bfdc-347fcdc34981" name="End" type="End"><subsheetid>3eacbbb6-d03e-4df7-9904-a3b1ac67c882</subsheetid><loginhibit /><display x="15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="ce5d2c13-15b8-4abc-99e1-0c32e44cc795" name="Raise exception on any failure" type="Data"><subsheetid>3eacbbb6-d03e-4df7-9904-a3b1ac67c882</subsheetid><display x="-195" y="-30" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><alwaysinit /></stage><stage stageid="23fa0822-2b63-4407-87f4-9b37ce869e58" name="Start" type="Start"><subsheetid>3eacbbb6-d03e-4df7-9904-a3b1ac67c882</subsheetid><loginhibit /><display x="15" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Raise exception on any failure" narrative="Flag indicating if failure should cause an exception to be raised rather than a return of a success output value" stage="Raise exception on any failure" /></inputs><onsuccess>b1167043-5e4b-4cbf-bfdc-347fcdc34981</onsuccess></stage><stage stageid="0b2ebe92-b578-4aa3-b255-b75a73c135d8" name="Raise Exception If Appropriate" type="SubSheetInfo"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><display x="-195" y="-105" w="150" h="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="0ef42cb2-e5a9-47c2-9845-2471b9f41643" name="Start" type="Start"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><loginhibit /><display x="-45" y="-135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" stage="Success" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" stage="Error Message" /></inputs><onsuccess>9a7620f2-75fe-4415-a778-45b839268e52</onsuccess></stage><stage stageid="5e8228c7-ac43-4b93-986b-e5fb23a3e572" name="End" type="End"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><loginhibit /><display x="-45" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /></stage><stage stageid="9a7620f2-75fe-4415-a778-45b839268e52" name="Should Raise Exception?" type="Decision"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><loginhibit /><display x="-45" y="-90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success] = False AND [Raise exception on any failure]" /><ontrue>c161d6a7-6f02-4f29-8c41-2d93471ae952</ontrue><onfalse>5e8228c7-ac43-4b93-986b-e5fb23a3e572</onfalse></stage><stage stageid="c161d6a7-6f02-4f29-8c41-2d93471ae952" name="FAIL" type="Exception"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><display x="30" y="-90" w="30" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><exception type="Action Failed" detail="[Error Message]" /></stage><stage stageid="1c7fc106-01f3-4a2a-aa7e-44c44875fb04" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>459569f2-c792-4948-8884-5c2a0917cc16</subsheetid><loginhibit /><display x="-60" y="-45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>7295054b-4d97-4891-ab69-23416df80d09</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="5705d9af-28ea-4c05-832b-4f40d34a3511" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="135" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>dd554ab9-61de-4d37-bee5-c25e1a5c74f1</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="a0610c45-e0f3-48ce-86be-2d9fe00d5faf" name="Success?" type="Decision"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="120" y="45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Success]" /><ontrue>0441a51b-0a7c-49e6-8305-4a877c32cc8a</ontrue><onfalse>52f9aedd-8666-495d-a007-ef3c02028ee7</onfalse></stage><stage stageid="52f9aedd-8666-495d-a007-ef3c02028ee7" name="anchor5" type="Anchor"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="180" y="45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c0d90f91-927f-45e0-84a0-0d6b4e823f6c</onsuccess></stage><stage stageid="63aeb2d7-aeb8-41f2-9ea1-0fd0cea0da8d" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>9ccac2c0-2efd-4399-8d02-c71ac4d7e812</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="375d6173-3de9-4f72-bee6-b4ff132e1287" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="75" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>b17027f1-8559-430b-9f36-724b3097e487</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="dbe6faa5-9cd8-4ead-a98d-1880a84975af" name="anchor8" type="Anchor"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="135" y="-90" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>28719a2d-9d55-4414-8a91-4f3c8ce10cba</onsuccess></stage><stage stageid="ac70463c-d9f4-44cc-8427-004224405a91" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-15" y="45" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>7906b7ac-88bd-4971-991d-46bf74ab7207</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="63e4c694-de67-4b39-a04c-5af3186af635" name="anchor9" type="Anchor"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="135" y="45" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>ac70463c-d9f4-44cc-8427-004224405a91</onsuccess></stage><stage stageid="8173e4d5-0932-4184-b3e8-01a761341966" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="0" y="105" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>3098273a-9d5f-43bd-8f67-dd5fa306c621</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="0da291c6-e906-4852-b112-79384aafeb77" name="anchor10" type="Anchor"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="135" y="-30" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>047bee83-bd7d-43b1-aeb3-6f4183c42c63</onsuccess></stage><stage stageid="047bee83-bd7d-43b1-aeb3-6f4183c42c63" name="anchor11" type="Anchor"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="135" y="60" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>b565deea-e08d-4195-b081-ab4f2eaad4ad</onsuccess></stage><stage stageid="b565deea-e08d-4195-b081-ab4f2eaad4ad" name="anchor12" type="Anchor"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="135" y="105" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8173e4d5-0932-4184-b3e8-01a761341966</onsuccess></stage><stage stageid="8e6271bb-9473-4b6c-b90d-6832537a8075" name="anchor13" type="Anchor"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="120" y="-30" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>61bf908d-c640-41f1-921e-fbac0bc44b57</onsuccess></stage><stage stageid="61bf908d-c640-41f1-921e-fbac0bc44b57" name="anchor14" type="Anchor"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="120" y="60" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>63cca0a5-90a1-4eb5-9daa-65633aa5c6d3</onsuccess></stage><stage stageid="63cca0a5-90a1-4eb5-9daa-65633aa5c6d3" name="anchor15" type="Anchor"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="120" y="105" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8ecc58ce-889b-4d69-8dbd-43f4c4cb11aa</onsuccess></stage><stage stageid="8ecc58ce-889b-4d69-8dbd-43f4c4cb11aa" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-15" y="105" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>281eca77-1f39-4ace-8815-a8145727a1e3</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="ab15b6c7-3e1d-417a-9750-8ca92fb7924e" name="Note1" type="Note"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><narrative>Note that we don't throw an exception here even if a failure is encountered - this is probably being called as part of a wider action, and the caller has the context with which to decide where the exception should be raised.</narrative><display x="-195" y="75" w="270" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8fcd4c90-9846-476a-a7f4-05a7edc6e62b</onsuccess></stage><stage stageid="d5771181-59a5-4bfd-b8f1-01bd7b7dbb3d" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-45" y="75" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>469b68e3-523f-4723-ab11-b47348bbdf33</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="7dc1a88f-716e-4f2b-80dd-dd6306d6db07" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-45" y="75" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>f82dbcac-aaf6-4e85-ada7-e7f28d96bb97</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="69fcc128-f010-4628-a2ca-291756ca05b9" name="Raise Exception If Appropriate" type="SubSheet"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="15" y="90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Success" narrative="Flag indicating success or otherwise" expr="[Success]" /><input type="text" name="Error Message" narrative="The message detailing the lack of success, empty if the current state indicates success" expr="[Message]" /></inputs><onsuccess>029dc82b-e289-4579-8a43-d8b9c93158be</onsuccess><processid>88d8d9e5-f97e-40d6-b049-bb643eb06852</processid></stage><stage stageid="470e696c-742e-49d7-9421-f2a1544972f9" name="Success" type="Data"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><display x="-195" y="-30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4576bffa-323c-45f4-9233-9905d56e85ee" name="Error Message" type="Data"><subsheetid>88d8d9e5-f97e-40d6-b049-bb643eb06852</subsheetid><display x="-195" y="0" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="95b31d93-f94b-416b-84da-6fe8337d8feb" name="Closing" type="Data"><loginhibit /><narrative>Flag indicating that the connection wrapped by this VBO is currently in the process of closing</narrative><display x="180" y="255" w="180" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue>False</initialvalue><alwaysinit /></stage><stage stageid="e85c42a3-de4b-461c-8b38-c5f6f44cd4ce" name="Closing:=True" type="Calculation"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="-150" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>c16520e0-e8d3-41c0-ae96-6254e954bc1a</onsuccess><calculation expression="True" stage="Closing" /></stage><stage stageid="8c118cde-3b9a-4ed9-861d-f48b007e1200" name="Already Closing?" type="Decision"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="-195" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Closing]" /><ontrue>34659a52-f242-427f-988d-763542f1f33f</ontrue><onfalse>e85c42a3-de4b-461c-8b38-c5f6f44cd4ce</onfalse></stage><stage stageid="34659a52-f242-427f-988d-763542f1f33f" name="Note2" type="Note"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><narrative>Ensure that we're not being called by 'Rollback' which was called by this action - infinite loops are bad.</narrative><display x="150" y="-195" w="150" h="60" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>adf47186-7a7b-4396-b1cb-e994400f72c9</onsuccess></stage><stage stageid="adf47186-7a7b-4396-b1cb-e994400f72c9" name="anchor16" type="Anchor"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="150" y="105" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8fcd4c90-9846-476a-a7f4-05a7edc6e62b</onsuccess></stage><stage stageid="274a1082-2d15-4bf8-84f2-043aae4e60e7" name="Closing:=False" type="Calculation"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="60" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8fcd4c90-9846-476a-a7f4-05a7edc6e62b</onsuccess><calculation expression="False" stage="Closing" /></stage><stage stageid="56def720-71ec-4d7b-9e58-17b4f23dc6fc" name=" " type="Block"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="-60" y="-75" w="195" h="60" /><font family="Tahoma" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="aa70afba-b9df-48a6-a0c2-beb7fa5cdc82" name="Ignore" type="Recover"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="90" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>92889732-12eb-4041-ac27-8a9a20af1cf5</onsuccess></stage><stage stageid="92889732-12eb-4041-ac27-8a9a20af1cf5" name=" " type="Resume"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="90" y="15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>f5aab680-3f4a-4cb2-9873-7c2aa718133f</onsuccess></stage><stage stageid="22e10c68-07d1-4cc4-9072-7c9b0b0c97cf" name="SQL" type="Data"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-195" y="-30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="47ca5361-bb0f-4f18-9c74-7d5d09f239dd" name="SQL" type="Data"><subsheetid>a45f6098-73e2-4639-a002-31592645bfa5</subsheetid><loginhibit /><display x="-195" y="-30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="3616b67e-fe87-422b-b9ea-6180525fddc3" name="SQL" type="Data"><subsheetid>12d7c91f-29ac-4711-9614-7ab992dc4b1f</subsheetid><loginhibit /><display x="-195" y="-30" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="46a7daee-e5e4-441f-92fc-39a696518e79" name="SQL" type="Data"><subsheetid>18349d7d-79b1-4397-a8a0-490ab27f459f</subsheetid><loginhibit /><display x="-195" y="-30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d1d6948f-3783-4b3f-afa7-bef3378cafc3" name="SQL" type="Data"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="-195" y="-45" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="ae6e30b2-099e-4fd8-9481-75eeccea424a" name="SQL" type="Data"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-195" y="-30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="540222b0-7793-476e-a330-59f84b93108c" name="SQL" type="Data"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-195" y="-30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="66c19ef6-3007-4fa0-af27-b52892a9671c" name="Connection String already set?" type="Decision"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="15" y="-120" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[Connection String] &lt;&gt; &quot;&quot;" /><ontrue>5d9aed4f-c61b-40dc-9104-e0720a324d22</ontrue><onfalse>cb1901f1-02a7-4e86-8618-cef7a98b283f</onfalse></stage><stage stageid="90d7c944-c618-41dd-bfe2-5da022f3353a" name="Internal Close" type="SubSheet"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="150" y="-75" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="True" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>cb1901f1-02a7-4e86-8618-cef7a98b283f</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="5d9aed4f-c61b-40dc-9104-e0720a324d22" name="Note3" type="Note"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><narrative>Close and clear the connection pool</narrative><display x="150" y="-120" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>90d7c944-c618-41dd-bfe2-5da022f3353a</onsuccess></stage><stage stageid="fbf49160-dd35-4922-a2f3-6b17985bfb74" name="Close Success" type="Data"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><display x="-195" y="-30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="f81af5a5-7d4a-4f5d-b914-0b008c1273ec" name="Close Message" type="Data"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><display x="-195" y="0" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="cb1901f1-02a7-4e86-8618-cef7a98b283f" name="anchor17" type="Anchor"><subsheetid>90429413-7792-4513-8bc0-d6d079aa08b9</subsheetid><loginhibit /><display x="15" y="-75" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>3f4ca0da-93ad-492e-af65-ff637c54b37a</onsuccess></stage><stage stageid="042dd86c-3c68-4015-83b1-dcf5b036fc90" name="End" type="End"><subsheetid>109afac8-f6b2-467f-971c-c6141124b87a</subsheetid><loginhibit /><display x="-45" y="-45" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="8fcd4c90-9846-476a-a7f4-05a7edc6e62b" name="End" type="End"><subsheetid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</subsheetid><loginhibit /><display x="0" y="105" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="dd554ab9-61de-4d37-bee5-c25e1a5c74f1" name="End" type="End"><subsheetid>3ee937ec-012f-445c-9b2b-ebbcb6d3614d</subsheetid><loginhibit /><display x="15" y="180" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="9ccac2c0-2efd-4399-8d02-c71ac4d7e812" name="End" type="End"><subsheetid>ba712d56-697c-48af-bc96-85e49eb968fc</subsheetid><loginhibit /><display x="15" y="135" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="b17027f1-8559-430b-9f36-724b3097e487" name="End" type="End"><subsheetid>4b6e35c6-8ec4-4fbe-b9d7-d43c48492695</subsheetid><loginhibit /><display x="15" y="120" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="7906b7ac-88bd-4971-991d-46bf74ab7207" name="End" type="End"><subsheetid>c07ae8a2-a04f-46f2-8919-ec4da73d5b25</subsheetid><loginhibit /><display x="-15" y="90" /><font family="Tahoma" size="10" style="Regular" color="000000" /><outputs><output type="flag" name="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs></stage><stage stageid="3208f40f-75f3-4741-8a81-946beba36d44" name="Internal Close" type="SubSheet"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="45" y="15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>a32a083a-756d-4b40-9291-f7f28eb270ca</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="f6c917ac-401f-416b-9653-21ef09eb5511" name="In Transaction?" type="Decision"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="-45" y="15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>d5771181-59a5-4bfd-b8f1-01bd7b7dbb3d</ontrue><onfalse>3208f40f-75f3-4741-8a81-946beba36d44</onfalse></stage><stage stageid="a32a083a-756d-4b40-9291-f7f28eb270ca" name="anchor14" type="Anchor"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><loginhibit /><display x="90" y="15" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>6247786f-c914-40c2-9acb-156178f5b62d</onsuccess></stage><stage stageid="4433108f-34f9-4631-a8a6-bff749976cc1" name="Close Success" type="Data"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><display x="-195" y="90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="b181233f-ab04-4152-bc51-73962aee430e" name="Close Message" type="Data"><subsheetid>780529b8-393d-4d1d-bc5f-34f383fe53ec</subsheetid><display x="-195" y="120" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="83dc18a1-fd3c-48f5-9ae1-b73cdd6b678e" name="Internal Close" type="SubSheet"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="45" y="15" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>4657807d-cf0b-4fb1-99dc-00b8e1996c90</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="60210b0d-63bf-4d91-be71-5cb25dd207ee" name="In Transaction?" type="Decision"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="-45" y="15" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>7dc1a88f-716e-4f2b-80dd-dd6306d6db07</ontrue><onfalse>83dc18a1-fd3c-48f5-9ae1-b73cdd6b678e</onfalse></stage><stage stageid="4657807d-cf0b-4fb1-99dc-00b8e1996c90" name="anchor14" type="Anchor"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><loginhibit /><display x="90" y="15" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>8ee4a00c-f248-4c89-8c4b-4b86cb50ad50</onsuccess></stage><stage stageid="325179d6-6242-4239-845b-ad106e08f511" name="Close Success" type="Data"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><display x="-195" y="90" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="06158ecb-51fb-40fb-9222-0d1e90df3471" name="Close Message" type="Data"><subsheetid>13b6c91d-68e8-46e9-bcab-9261446dc0af</subsheetid><display x="-195" y="120" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="4173a1fb-41f8-40f9-b210-da8ee807d1fb" name="Internal Close" type="SubSheet"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="105" y="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><inputs><input type="flag" name="Clear Pool" narrative="True to clear the connection pool when closing the connection; False to just release the connection back into the pool" expr="False" /></inputs><outputs><output type="flag" name="Success" stage="Close Success" /><output type="text" name="Message" stage="Close Message" /></outputs><onsuccess>7cf58f46-d16c-44dd-ad75-b675ae326a72</onsuccess><processid>7ee7ad42-e017-40ff-92aa-3cfc5c6dd0e5</processid></stage><stage stageid="b2e92c46-8b47-47ad-a059-a7dbd0c185ea" name="In Transaction?" type="Decision"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="15" y="30" w="90" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><decision expression="[In Transaction]" /><ontrue>69fcc128-f010-4628-a2ca-291756ca05b9</ontrue><onfalse>4173a1fb-41f8-40f9-b210-da8ee807d1fb</onfalse></stage><stage stageid="7cf58f46-d16c-44dd-ad75-b675ae326a72" name="anchor14" type="Anchor"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><loginhibit /><display x="150" y="30" w="10" h="10" /><font family="Tahoma" size="10" style="Regular" color="000000" /><onsuccess>1303eb98-48c5-438c-aa5a-54fe90868c4f</onsuccess></stage><stage stageid="b78f2cf8-419e-4ce9-b829-b2bb751dd013" name="Close Success" type="Data"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><display x="-195" y="75" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1d7b6850-2750-455f-a164-b1816840c3d0" name="Close Message" type="Data"><subsheetid>e50a93aa-11fe-4457-a16d-0237560fff18</subsheetid><display x="-195" y="105" w="120" h="30" /><font family="Tahoma" size="10" style="Regular" color="000000" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage></process></object>
        <object id="adff058d-9f84-4470-bbef-c2fd1c011d03" name="SQLSERVER" xmlns="http://www.blueprism.co.uk/product/process"><process name="SQLSERVER" version="1.0" bpversion="6.8.0.23415" narrative="" byrefcollection="true" type="object" runmode="Exclusive"><appdef><element name="Application Root"><id>c41b81ac-8991-4c44-b06b-12e54e6ce256</id><type>Application</type><basetype>Application</basetype><datatype>unknown</datatype><diagnose>False</diagnose></element></appdef><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view><preconditions /><endpoint narrative="" /><subsheet subsheetid="181832f3-eb95-41ca-a598-1fad7428f1be" type="CleanUp" published="True"><name>Clean Up</name><view><camerax>0</camerax><cameray>0</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="fa60835b-dc12-4de9-b241-cfc0921c0fe7" type="Normal" published="False"><name>Insert data excel in Database</name><view><camerax>0</camerax><cameray>141</cameray><zoom version="2">1.25</zoom></view></subsheet><subsheet subsheetid="505fd234-129d-4752-8783-dda777151a85" type="Normal" published="False"><name>Get Value By User</name><view><camerax>21</camerax><cameray>281</cameray><zoom version="2">1.25</zoom></view></subsheet><stage stageid="2aad314d-43ec-4755-a67a-eaa4e575d2dc" name="Start" type="Start"><loginhibit /><display x="15" y="-105" /><onsuccess>44ac1c16-9b98-4ed3-895a-aac0822f6891</onsuccess></stage><stage stageid="44ac1c16-9b98-4ed3-895a-aac0822f6891" name="End" type="End"><loginhibit /><display x="15" y="90" /></stage><stage stageid="66a70132-0f80-4e35-8f47-aa51f7aacffa" name="Stage1" type="ProcessInfo"><display x="-195" y="-105" w="150" h="90" /><references><reference>System.dll</reference><reference>System.Data.dll</reference><reference>System.Xml.dll</reference><reference>System.Drawing.dll</reference></references><imports><import>System</import><import>System.Drawing</import><import>System.Data</import></imports><language>visualbasic</language><globalcode><![CDATA[]]></globalcode><code><![CDATA[]]></code></stage><stage stageid="8c60d850-8a29-4066-be4d-a01a31a68bf5" name="Clean Up" type="SubSheetInfo"><subsheetid>181832f3-eb95-41ca-a598-1fad7428f1be</subsheetid><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="7e80c636-23c5-4d0a-b849-d8533dffe479" name="Start" type="Start"><subsheetid>181832f3-eb95-41ca-a598-1fad7428f1be</subsheetid><loginhibit /><display x="15" y="-105" /><onsuccess>af881d23-b768-43f9-98d7-2ac7719d1507</onsuccess></stage><stage stageid="af881d23-b768-43f9-98d7-2ac7719d1507" name="End" type="End"><subsheetid>181832f3-eb95-41ca-a598-1fad7428f1be</subsheetid><loginhibit /><display x="15" y="90" /></stage><stage stageid="170e7039-0007-4f12-90d5-f265b0c8d31d" name="Note1" type="Note"><subsheetid>181832f3-eb95-41ca-a598-1fad7428f1be</subsheetid><narrative>Clean Up Page

This is an optional page where you might choose to perform some finalisation (or "cleanup") tasks as your business object is closed down.

The cleanup action will be called automatically immediately after closing your business object at the end of a business process.

You will not be able to call this action from a business process, nor will it be called at any other time than before the disposal of the business object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="200b3f5d-3316-4a33-9ac7-af28308ea0d7" name="Note2" type="Note"><narrative>Initialise Page

This is an optional page where you might choose to perform some initialisation tasks after your business object is loaded.

The initialise action will be called automatically immediately after loading your business object.

You will not be able to call this action from a business process, nor will it be called at any other time than after the creation of the object.</narrative><display x="-180" y="60" w="180" h="230" /></stage><stage stageid="0c351f04-f4d8-4ff1-8841-10bfbe79567e" name="Insert data excel in Database" type="SubSheetInfo"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><narrative>Insert de dados pegando os valores informados do excel. Com base no file name obtem os valores do excel e manda os dados para  fazer o insert dentro da base de dados</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="ef43a1d1-fb85-453f-bd0f-eabe77e75aa9" name="Start" type="Start"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="15" y="-105" /><inputs><input type="text" name="file path" stage="file name" /><input type="text" name="Server" stage="Server" /><input type="text" name="Database" stage="Database" /><input type="password" name="Password" stage="Password" /><input type="text" name="User" stage="User" /></inputs><onsuccess>cc2e70a6-3476-4d8b-8a81-e410ef695e3e</onsuccess></stage><stage stageid="b3ea3e02-fafe-4bd5-94ca-a7c13e381f6c" name="End" type="End"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="15" y="255" /><outputs><output type="flag" name="Success" stage="Success" /><output type="text" name="Message" stage="Message" /></outputs></stage><stage stageid="cc2e70a6-3476-4d8b-8a81-e410ef695e3e" name="MS Excel VBO::Create Instance" type="Action"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-60" /><inputs><input type="flag" name="Enable Events" friendlyname="Enable Events" narrative="Flag to indicate that events should be enabled / disabled on the attached instance - defaulted to True" expr="[Enable Events]" /></inputs><outputs><output type="number" name="handle" friendlyname="handle" narrative="An integer which can be used to identify the created instance in subsequent actions" stage="handle" /></outputs><onsuccess>9c037405-de90-40ec-8273-06a8adf9c31a</onsuccess><resource object="MS Excel VBO" action="Create Instance" /></stage><stage stageid="7a1d5f13-50ac-43d0-a006-746609bc9462" name="handle" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-225" y="-15" /><datatype>number</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="9c037405-de90-40ec-8273-06a8adf9c31a" name="MS Excel VBO::Open Workbook" type="Action"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="-15" /><inputs><input type="number" name="handle" friendlyname="handle" narrative="The integer handle identifying the instance on which the required workbook should be opened. The default of zero indicates the currently active instance." expr="[handle]" /><input type="text" name="File name" friendlyname="File name" narrative="The path and name of the file which should be opened." expr="[file name]" /></inputs><outputs><output type="text" name="Workbook Name" friendlyname="Workbook Name" narrative="The name used by Excel to identify the workbook - usually this is the file name (without the path)." stage="Workbook Name" /></outputs><onsuccess>46ba2c98-2324-4455-ba7c-d03034b9738e</onsuccess><resource object="MS Excel VBO" action="Open Workbook" /></stage><stage stageid="60b5a8fb-3b87-4964-b03f-f62ee9b13c1b" name="Workbook Name" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-165" y="-15" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="46ba2c98-2324-4455-ba7c-d03034b9738e" name="MS Excel VBO::Get Worksheet As Collection (Fast)" type="Action"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="30" /><outputs><output type="collection" name="Data" friendlyname="Data" narrative="The data output" stage="Data Excel" /></outputs><onsuccess>a9daeaa6-fb24-42ab-b251-775696ceff3b</onsuccess><resource object="MS Excel VBO" action="Get Worksheet As Collection (Fast)" /></stage><stage stageid="6c757a88-8ce1-46a2-a9f4-09fb5a0a8ede" name="Data Excel" type="Collection"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-225" y="30" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Project" type="text" /><field name="Client" type="text" /><field name="Description" type="text" /><field name="Task" type="text" /><field name="User" type="text" /><field name="Email" type="text" /><field name="Tags" type="text" /><field name="Billable" type="text" /><field name="Start Date" type="date" /><field name="Start Time" type="time" /><field name="End Date" type="date" /><field name="End Time" type="time" /><field name="Duration (h)" type="time" /><field name="Duration (decimal)" type="number" /><field name="Billable  Rate (USD)" type="number" /><field name="Billable Amount (USD)" type="number" /></collectioninfo></stage><stage stageid="c5b43bd7-cf36-425d-a7fd-8836ef3f0b5d" name="Loop Data excel" type="LoopStart"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="15" y="120" /><onsuccess>a2b28b6f-6d8a-46b8-ae6a-ea9e8c3a2eac</onsuccess><groupid>2a6d031c-4e27-4e93-902c-343ca5772bb5</groupid><looptype>ForEach</looptype><loopdata>Data Excel</loopdata></stage><stage stageid="b82acd61-12c1-4555-b22f-be397256e2b9" name="Loop Data excel" type="LoopEnd"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="15" y="210" /><onsuccess>b3ea3e02-fafe-4bd5-94ca-a7c13e381f6c</onsuccess><groupid>2a6d031c-4e27-4e93-902c-343ca5772bb5</groupid></stage><stage stageid="a9daeaa6-fb24-42ab-b251-775696ceff3b" name="Data - SQL Server::Set Connection" type="Action"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="75" /><inputs><input type="text" name="Server" friendlyname="Server" narrative="The name of the server and, if necessary, instance name of the SQL Server instance to connect to" expr="[Server]" /><input type="text" name="Database" friendlyname="Database" narrative="The name of the database to connect to" expr="[Database]" /><input type="text" name="User" friendlyname="User" narrative="If appropriate, the login name to use to connect to SQL Server. If left empty, windows authentication using the current user will be used instead of SQL Server authentication" expr="[User]" /><input type="password" name="Password" friendlyname="Password" narrative="If appropriate, the password to use with the above login name to access SQL Server. Unused for windows authentication" expr="[Password]" /></inputs><onsuccess>c5b43bd7-cf36-425d-a7fd-8836ef3f0b5d</onsuccess><resource object="Data - SQL Server" action="Set Connection" /></stage><stage stageid="a2b28b6f-6d8a-46b8-ae6a-ea9e8c3a2eac" name="Execute Query" type="Action"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit onsuccess="true" /><display x="15" y="165" /><inputs><input type="text" name="Query" friendlyname="Query" narrative="The SQL query to use to perform this action" expr="&quot;insert into clockify(email, duration, data) &quot; &amp; &#xA; &quot;values('&quot; &amp; [Data.Email]&amp; &#xA; &quot;',&quot; &amp; &quot;CONVERT(time, '&quot; &amp; [Data.Duration (h)] &amp; &quot;', 1)&quot; &amp; &#xA; &quot;,&quot; &amp; &quot;CONVERT(date, '&quot; &amp; [Data.End Date] &amp; &quot;', 103)&quot; &amp;&#xA; &quot;)&quot;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag indicating success (True) or failure (False)" stage="Success" /><output type="text" name="Message" friendlyname="Message" narrative="Error message giving detail regarding why this action failed" stage="Message" /></outputs><onsuccess>b82acd61-12c1-4555-b22f-be397256e2b9</onsuccess><resource object="Data - SQL Server" action="Execute" /></stage><stage stageid="762aed4e-8a9c-4708-b092-55827e115542" name="Success" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-165" y="120" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0297c2d3-b6c4-4efc-9b84-ba9fbb091ea0" name="Message" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-225" y="120" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="70c01030-a19f-4b0a-837a-82c58200587a" name="Get Value By User" type="SubSheetInfo"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><narrative>Processo de busca dos dados do banco de acordo com o email informado. O email é obtido a 
partir da collection do excel do clockify</narrative><display x="-195" y="-105" w="150" h="90" /></stage><stage stageid="23dbd873-b5df-4152-9a7a-2c3b667855d3" name="Start" type="Start"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="-30" /><inputs><input type="collection" name="Excel Clockify" stage="ClockifyCollection" /><input type="text" name="Server" stage="Server" /><input type="text" name="Database" stage="Database" /><input type="text" name="User" stage="User" /><input type="password" name="Password" stage="Password" /></inputs><onsuccess>cbaf1f6f-3c06-4296-aa52-4215925329e2</onsuccess></stage><stage stageid="cbaf1f6f-3c06-4296-aa52-4215925329e2" name="Data - SQL Server::Set Connection" type="Action"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit onsuccess="true" /><display x="15" y="15" /><inputs><input type="text" name="Server" friendlyname="Server" narrative="The name of the server and, if necessary, instance name of the SQL Server instance to connect to" expr="[Server]" /><input type="text" name="Database" friendlyname="Database" narrative="The name of the database to connect to" expr="[Database]" /><input type="text" name="User" friendlyname="User" narrative="If appropriate, the login name to use to connect to SQL Server. If left empty, windows authentication using the current user will be used instead of SQL Server authentication" expr="[User]" /><input type="password" name="Password" friendlyname="Password" narrative="If appropriate, the password to use with the above login name to access SQL Server. Unused for windows authentication" expr="[Password]" /></inputs><onsuccess>b8a8b4d8-81ca-40bf-b4f5-c0fbc372d9aa</onsuccess><resource object="Data - SQL Server" action="Set Connection" /></stage><stage stageid="f984686d-5519-450a-8e3f-a57d0e1b4b37" name="Sucesso" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-210" y="0" /><datatype>flag</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="09472e69-d463-42fb-a8bd-131973f08b7b" name="Mensagem" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-150" y="0" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="741f36ad-4ead-48ea-b634-a6ef2447ee36" name="Results" type="Collection"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-270" y="0" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Id" type="number" /><field name="email" type="text" /><field name="duration" type="timespan" /><field name="data" type="date" /></collectioninfo></stage><stage stageid="6d65e283-341f-473a-8d46-ac2d36a6c135" name="Loop Collection Database" type="LoopStart"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="270" /><onsuccess>2ecd6dd7-fbc4-4137-9380-face2f789935</onsuccess><groupid>c911fd6d-f994-4693-87f1-36a7f8a07637</groupid><looptype>ForEach</looptype><loopdata>Results</loopdata></stage><stage stageid="4f237342-fc5e-4567-9d55-894a8b4c09b4" name="Loop Collection Database" type="LoopEnd"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="375" /><onsuccess>f837a3bf-43f7-494d-9483-beaf8566fda6</onsuccess><groupid>c911fd6d-f994-4693-87f1-36a7f8a07637</groupid></stage><stage stageid="28c982fe-25f8-4b7a-8c11-6d7c9f893e5b" name="Time" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-150" y="90" /><datatype>timespan</datatype><initialvalue>0.00:00:00</initialvalue><private /><alwaysinit /></stage><stage stageid="70b6d0b6-740e-4b73-97e3-0d975357fed0" name="Hours" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-210" y="90" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="2d74f6dc-276f-437e-90ae-bd92ae709b1d" name="Minutes" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-270" y="90" /><datatype>number</datatype><initialvalue>0</initialvalue><private /><alwaysinit /></stage><stage stageid="837d7c3c-c991-4220-adf0-47bac145ee6d" name="End1" type="End"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="555" /><outputs><output type="collection" name="Resultado Clockify" stage="Resultado Clockify" /><output type="flag" name="Success" stage="Sucesso" /><output type="text" name="Message" stage="Mensagem" /></outputs></stage><stage stageid="2ecd6dd7-fbc4-4137-9380-face2f789935" name="Count Time" type="Calculation"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="315" /><onsuccess>4f237342-fc5e-4567-9d55-894a8b4c09b4</onsuccess><calculation expression="[Time] + [Results.duration]" stage="Time" /></stage><stage stageid="57d7fda6-243d-4f02-9fa3-b446bde5a75d" name="Add Collection Clockify" type="MultipleCalculation"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="465" /><onsuccess>40afe6e6-e78a-4e05-9777-5d98a1f26344</onsuccess><steps><calculation expression="ToHours([Time])" stage="Hours" /><calculation expression="ToMinutes([Time])" stage="Minutes" /><calculation expression="[Hours]" stage="Resultado Clockify.Hours" /><calculation expression="[Minutes]" stage="Resultado Clockify.Minutes" /><calculation expression="[ClockifyCollection.Email]" stage="Resultado Clockify.Email" /></steps></stage><stage stageid="6d6da679-5a40-4804-ae19-58cbd8582f4a" name="Time" type="Block"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-315" y="60" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="c6ee7902-5ddc-404f-83ab-52ab4f82360b" name="Block2" type="Block"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-315" y="-30" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="7599c3be-be49-42c3-89b7-38a31274a03c" name="Data - SQL Server::Get Collection" type="Action"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit onsuccess="true" /><display x="15" y="105" /><inputs><input type="text" name="SQL" friendlyname="SQL" narrative="The SQL query to use to perform this action" expr="&quot;select * from clockify &#xA;&#x9;where email = &quot; &amp; &quot;'&quot; &amp;  [ClockifyCollection.Email] &amp; &quot;'&quot; &amp; &quot;  and &#xA;&#x9;data &gt;= CONVERT(date,'&quot; &amp; [ClockifyCollection.Start Date] &amp; &quot;', 103) and &#xA;&#x9;data &lt;= CONVERT(date, '18/09/2020', 103);&quot;&#xA;" /></inputs><outputs><output type="flag" name="Success" friendlyname="Success" narrative="Flag indicating success (True) or failure (False)" stage="Sucesso" /><output type="text" name="Message" friendlyname="Message" narrative="Error message giving detail regarding why this action failed" stage="Mensagem" /><output type="collection" name="Results" friendlyname="Results" narrative="The collection of results from the query" stage="Results" /></outputs><onsuccess>238ea5b9-1e28-4fb2-8688-5905928e9006</onsuccess><resource object="Data - SQL Server" action="Get Collection" /></stage><stage stageid="977ebb57-a0d9-4c31-a2f7-78b5c042eb93" name="Excel" type="Block"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="-270" y="-45" w="150" h="105" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="e5e31f91-5c02-4d16-bb11-852e206f4cd4" name="Query execute" type="Block"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="-270" y="75" w="150" h="75" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="b8a8b4d8-81ca-40bf-b4f5-c0fbc372d9aa" name="Loop Excel Clockify" type="LoopStart"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="60" /><onsuccess>7599c3be-be49-42c3-89b7-38a31274a03c</onsuccess><groupid>8d0651f1-80ca-4315-ac82-74cd7845055d</groupid><looptype>ForEach</looptype><loopdata>ClockifyCollection</loopdata></stage><stage stageid="40afe6e6-e78a-4e05-9777-5d98a1f26344" name="Loop Excel Clockify" type="LoopEnd"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="510" /><onsuccess>837d7c3c-c991-4220-adf0-47bac145ee6d</onsuccess><groupid>8d0651f1-80ca-4315-ac82-74cd7845055d</groupid></stage><stage stageid="238ea5b9-1e28-4fb2-8688-5905928e9006" name="Initialize data Item" type="MultipleCalculation"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="165" /><onsuccess>1f1bc743-8a4b-4f10-98fa-492c45b6a614</onsuccess><steps><calculation expression="0" stage="Hours" /><calculation expression="0" stage="Minutes" /><calculation expression="&quot;00:00:00&quot;" stage="Time" /></steps></stage><stage stageid="6f80fd79-18cc-41eb-97ec-f36054d58158" name="ClockifyCollection" type="Collection"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-225" y="180" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Project" type="text" /><field name="Client" type="text" /><field name="Description" type="text" /><field name="Task" type="text" /><field name="User" type="text" /><field name="Email" type="text" /><field name="Tags" type="text" /><field name="Billable" type="text" /><field name="Start Date" type="date" /><field name="Start Time" type="time" /><field name="End Date" type="date" /><field name="End Time" type="time" /><field name="Duration (h)" type="time" /><field name="Duration (decimal)" type="number" /><field name="Billable  Rate (USD)" type="number" /><field name="Billable Amount (USD)" type="number" /></collectioninfo></stage><stage stageid="6943f2a3-55e1-4106-8662-3740a439892c" name="Resultado Clockify" type="Collection"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-225" y="285" /><datatype>collection</datatype><private /><alwaysinit /><collectioninfo><field name="Email" type="text" /><field name="Hours" type="number" /><field name="Minutes" type="number" /></collectioninfo></stage><stage stageid="f837a3bf-43f7-494d-9483-beaf8566fda6" name="Add Row" type="Action"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit onsuccess="true" /><display x="15" y="420" /><inputs><input type="text" name="Collection Name" friendlyname="Collection Name" narrative="The name of the collection to act upon" expr="&quot;Resultado Clockify&quot;" /></inputs><onsuccess>57d7fda6-243d-4f02-9fa3-b446bde5a75d</onsuccess><resource object="Blueprism.AutomateProcessCore.clsCollectionActions" action="Add Row" /></stage><stage stageid="ae095062-df41-4101-bee0-3225667501d4" name="file name" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-420" y="0" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="1987b3cf-681e-443a-aa02-e11e660774a7" name="Inputs" type="Block"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="-465" y="-45" w="150" h="90" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="4a8a186b-ceb1-45c7-b219-dea58b1aba59" name="Enable Events" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-165" y="30" /><datatype>flag</datatype><initialvalue>False</initialvalue><private /><alwaysinit /></stage><stage stageid="db949bd0-e551-44be-9e4a-ea74b787e36d" name="Server" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-420" y="120" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="d04e6604-1bdb-413c-bbdf-481b686262d8" name="Database" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-360" y="165" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5906733f-95f3-4081-a879-d9cb59a1407d" name="User" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-360" y="120" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="0d0f7dc0-0fc9-4163-a3e2-0c575608a01a" name="Password" type="Data"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><display x="-420" y="165" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage><stage stageid="b3be4913-4c76-422f-ba31-9a2c48edb68d" name="Inputs Database Configuration" type="Block"><subsheetid>fa60835b-dc12-4de9-b241-cfc0921c0fe7</subsheetid><loginhibit /><display x="-465" y="75" w="150" h="120" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="1f1bc743-8a4b-4f10-98fa-492c45b6a614" name="Query Execute  ?" type="Decision"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="15" y="210" /><decision expression="[Sucesso]" /><ontrue>6d65e283-341f-473a-8d46-ac2d36a6c135</ontrue><onfalse>ff5473e6-3491-4e40-a145-6e18fa0338a5</onfalse></stage><stage stageid="2e77d933-bfd8-43e3-86ec-2e9f2c9cb2f7" name="Output" type="Block"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-315" y="255" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="80fcf1ae-4866-47b6-ad52-c85daa5ab0ea" name="Input" type="Block"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-315" y="150" w="195" h="60" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="ff5473e6-3491-4e40-a145-6e18fa0338a5" name="Anchor1" type="Anchor"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="180" y="210" w="10" h="10" /><onsuccess>fa991810-a56c-4f7c-bcf0-fe2f0aa410a0</onsuccess></stage><stage stageid="fa991810-a56c-4f7c-bcf0-fe2f0aa410a0" name="Anchor2" type="Anchor"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="180" y="510" w="10" h="10" /><onsuccess>40afe6e6-e78a-4e05-9777-5d98a1f26344</onsuccess></stage><stage stageid="d071e617-c118-4881-8b9b-0935604ae18e" name="Input Database Configuration" type="Block"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><loginhibit /><display x="-315" y="345" w="195" h="120" /><font family="Segoe UI" size="10" style="Regular" color="7FB2E5" /></stage><stage stageid="58c80f19-16b5-4a5b-b18b-5e373a2589c0" name="Server" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-270" y="435" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="730232af-0e9a-419d-bea0-aa73dc4d019a" name="Database" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-270" y="390" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="6fa84b4b-b050-488f-a8bc-d5c19d1a10a4" name="User" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-180" y="390" /><datatype>text</datatype><initialvalue /><private /><alwaysinit /></stage><stage stageid="5b1da46b-5ae7-4b0e-8923-02b1e0e0b62f" name="Password" type="Data"><subsheetid>505fd234-129d-4752-8783-dda777151a85</subsheetid><display x="-180" y="435" /><datatype>password</datatype><initialvalueenc></initialvalueenc><private /><alwaysinit /></stage></process></object>
        <object-group id="7c580886-e058-4d2b-96d5-7fb0e02c8bf0" name="Default" isDefaultGroup="True" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="29192c0f-d13c-4769-bed3-9c51217efab4" />
            </members>
        </object-group>
        <object-group id="342e802f-c12c-46a8-973c-110c47fdbbf5" name="System" isDefaultGroup="False" xmlns="http://www.blueprism.co.uk/product/object-group">
            <members>
                <object id="adff058d-9f84-4470-bbef-c2fd1c011d03" />
            </members>
        </object-group>
    </bpr:contents>
</bpr:release>